A51 MACRO ASSEMBLER  LR2                                                                  10/22/2023 11:13:52 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\LR2.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE LR2.asm SET(SMALL) DEBUG PRINT(.\Listings\LR2.lst) OBJECT(.\Objects\LR2
                      .obj) EP

LOC  OBJ            LINE     SOURCE

                       1     ;–°     –ê      –§      –û      –ù      –û      –í
                       2     ;43h    61h     E4h     6Fh     BDh     6Fh     B3h
                       3     ;00h    01h     02h     03h     04h     05h     06h      <- In DRAM (+80h = 8xh)
                       4     
                       5     ;–ê     -       0       7       -       2       0
                       6     ;61h    2Dh     30h     37h     2Dh     32h     30h
                       7     ;40h    41h     42h     43h     44h     45h     46h      <- In DRAM (+80h = Cxh)
                       8     
                       9     
                      10     ; MOV   direct, #data - 2 Cycles
                      11     ; SETB  bit - 1 Cycle
                      12     ; "t.e.": 1 * 12[takt] = 12 takts = 12 * 1/12 [MHz] = 12 * 83 [ns] = 996 > 230 ns
                      13     
  0080                14     FRST equ 0x80
                      15     ;SCND equ 0xC0          
                      16     
0023                  17     org     0023h                                           ; IRQ UART
0023 02804B           18             jmp             INT_UART
                      19     
----                  20     dseg at 0030h
                      21             
0030                  22             COM_DATA:       ds              8
                      23             
----                  24     cseg at 8000h
8000 803E             25             jmp             start
                      26     
8040                  27     org 8040h
                      28     
8040                  29     start:
                      30     ; =======================================================================================
8040 7830             31             mov             r0,     #COM_DATA               ; –∑–∞–ø–∏—Å—å –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏–
                             Ω—è—Ç—ã—Ö —Å COM-–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –≤ R0
                      32             
                      33     ; --- –ù–ê–°–¢–†–û–ô–ö–ê –ñ–ö-–î–ò–°–ü–õ–ï–Ø ----------------------------------------------
                             ----------------
8042 1173             34             call    lcdini                  ; –≤—ã–∑–æ–≤ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–Ω–∏—Ü–∏–∞–
                             ª–∏–∑–∞—Ü–∏–∏
8044 7E80             35             mov             r6, #FRST 
8046 D2AC             36             setb    IE.4                            ; –±–∏—Ç –º–∞—Å–∫–∏ UART (–¥–∏–∑—ä—é–Ω–∫—Ü–
                             ∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ IRQ –æ—Ç –ø—Ä–∏–µ–º–Ω–∏–∫–∞ –∏ –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∞); 
8048 00               37             nop
                      38     
8049 80FE             39     jmp     $
                      40     ; ======================================================================================
                      41     
                      42     ; --- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –æ—Ç UART -----------------------------------
                             ------------------
804B                  43     INT_UART:
                      44     ; –ù–ê–°–¢–†–û–ô–ö–ê –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–ì–û –ü–û–†–¢–ê
804B 759870           45             mov             SCON, #01110000b        ; —É—Å—Ç–∞–Ω–æ–≤–∫–∞ 1-–≥–æ (–∞—Å–∏–Ω—Ö—Ä.)
                              —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã UART
                      46                                                                             ; 0 - –û–±–Ω—É–ª–∏—
                             Ç—å RI - –§–ª–∞–≥ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –ø—Ä–∏–µ–º–Ω–∏–∫–∞ (–∞–∫—Ç–∏–≤–µ–Ω, –µ—Å–ª–∏ –ø—Ä–∏–Ω—è—Ç –±–∞–π—Ç –¥–∞–Ω–Ω—ã—Ö)
                      47                                                                             ; 1 - –û–±–Ω—É–ª–∏—
                             Ç—å TI - –§–ª–∞–≥ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∞ (–∞–∫—Ç–∏–≤–µ–Ω, –µ—Å–ª–∏ –±–
                             ∞–π—Ç –ø–µ—Ä–µ–¥–∞–Ω –≤ –ª–∏–Ω–∏—é) 
                      48                                                                             ; 2 - –û–±–Ω—É–ª–∏—
A51 MACRO ASSEMBLER  LR2                                                                  10/22/2023 11:13:52 PAGE     2

                             Ç—å RB8 - –ø—Ä–∏–µ–º 9-–≥–æ –±–∏—Ç–∞ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ 2 –∏ 3 –∏–ª–∏ —Å—Ç–æ–ø-–±–∏—Ç–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ 1
                      49                                                                             ; 3 - –û–±–Ω—É–ª–∏—
                             Ç—å TB8 - –ø–µ—Ä–µ–¥–∞—á–∞ 9-–≥–æ –±–∏—Ç–∞ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ 2 –∏ 3 
                      50                                                                             ; 4 - [–†–∞–∑—Ä–µ—à
                             –µ–Ω–∏–µ]/–∑–∞–ø—Ä–µ—Ç –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
                      51                                                                             ; 5 - –ü—Ä–æ–≤–µ—Ä—
                             è—Ç—å –æ—à–∏–±–∫—É –∫–∞–¥—Ä–∞ (–ø—Ä–∏—ë–º –Ω—É–ª–µ–≤–æ–≥–æ –±–∏—Ç–∞ –Ω–∞ –º–µ—Å—Ç–µ —Å—Ç–æ–ø-–±–∏—Ç–∞) 
                      52                                                                             ;     —É—Å—Ç–∞–Ω–∞–
                             ≤–ª–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –∑–∞–ø—Ä–µ—Ç–∞ –ø—Ä–∏–µ–º–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –≤ –∫–æ—Ç–æ—Ä—ã—Ö 
                             –¥–µ–≤—è—Ç—ã–π –±–∏—Ç –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 0 (—Ä–µ–∂–∏–º—ã 1, 2 –∏ 3)
                      53                                                                             ; 6,7 - –†–µ–∂–∏–º 
                             —Ä–∞–±–æ—Ç—ã UART: 01 - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –æ–±–º–µ–Ω, 8 –±–∏—Ç, –∏–∑–º–µ–Ω—è–µ–º–∞—è —
                             Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏
                      54                                       
                      55     ; –†–µ–∂–∏–º 1 (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –æ–±–º–µ–Ω). –î–∞–Ω–Ω—ã–µ –≤—ã–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–
                             ∑ –ª–∏–Ω–∏—é Tx, –∞ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Rx (–ø–æ–ª–Ω–æ–¥—É–ø–ª–µ–∫—Å–Ω—ã–π —Ä–µ–∂–∏–º). 
                      56     ; –ü–∞–∫–µ—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π: —Å—Ç–∞—Ä—Ç-–±–∏—Ç, 8 –±–
                             ∏—Ç –¥–∞–Ω–Ω—ã—Ö, —Å—Ç–æ–ø-–±–∏—Ç. –ü—Ä–∏—á–µ–º –ø—Ä–∏ –ø—Ä–∏–µ–º–µ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ø-–
                             ±–∏—Ç –∑–∞–Ω–æ—Å–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä—è–¥ RB8 —Ä–µ–≥–∏—Å—Ç—Ä–∞ SCON. 
                      57     ; –°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ø–æ—Ä—Ç–∞ –∑–∞–¥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ç–∞–π–º–µ—Ä–
                             ∞/—Å—á–µ—Ç—á–∏–∫–∞1.
                      58     
804E 53890F           59         anl         TMOD, #00001111b        ; "—Å–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫" —Ç–∞–π–º–µ—Ä–∞ T1 (
                             T0 –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º)
8051 438920           60             orl             TMOD, #00100000b        ; —É—Å—Ç–∞–Ω–æ–≤–∫–∞ 2-–≥–æ (???) —Ä–µ–∂–∏–
                             º–∞ —Ä–∞–±–æ—Ç—ã –¥–ª—è —Ç–∞–π–º–µ—Ä–∞ T1
                      61                                                                             ; 7 [Gate] - —Ç–∞–π
                             –º–µ—Ä —Ä–∞–∑—Ä–µ—à–µ–Ω, –µ—Å–ª–∏ –±–∏—Ç TCON.TRn —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç INT0)
                      62                                                                             ; 6 [C/T] - —Ç–∞–π–
                             º–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å –¥–µ–ª–∏—Ç–µ–ª–µ–º –Ω–∞ 12
                      63                                                                             ; 5,4 [M1,M0] - –ø–
                             µ—Ä–µ–≤–æ–¥ —Ç–∞–π–º–µ—Ä–∞ T1 –≤ —Ä–µ–∂–∏–º —Å—á—ë—Ç–∞ 8 –±–∏—Ç —Å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
                      64                                                                             ; 3-0 - –≤—Å—ë –∞–Ω
                             –∞–ª–æ–≥–∏—á–Ω–æ, –Ω–æ –¥–ª—è —Ç–∞–π–º–µ—Ä–∞ –¢0
                      65                                                                             
                      66     ; –†–µ–∂–∏–º 2 ‚Äì –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ—Å–ª–µ
                             –¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞. –ö–æ–≥–¥–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—á–µ—Ç—á–∏–∫–∞ TLn –
                             ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è, –≤ –Ω–µ–≥–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ 
                      67     ; —Å—á–µ—Ç—á–∏–∫–∞ THn, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–µ–≥–∏—Å—Ç—Ä (–Ω–µ –∏–∑–º–
                             µ–Ω—è–µ—Ç—Å—è –≤ —Ö–æ–¥–µ —Å—á–µ—Ç–∞, –Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ). –ò —Å—á–
                             µ—Ç –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –∞ —Å–∏–≥–Ω–∞–ª –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è 
                      68     ; –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±–º–µ–Ω–∞ –ø–æ—Å–ª–µ–¥
                             –æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ (UART).
                      69     
                      70     ; –ù–ê–°–¢–†–û–ô–ö–ê –¢–ê–ô–ú–ï–†–ê
8054 53883F           71             anl             TCON, #00111111b                ; "–æ—Å—Ç–∞–Ω–æ–≤–∫–∞" —Ç–∞–π–º–µ—Ä
                             –∞ T1 (T0 –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º)
8057 758CFD           72             mov             TH0, #0xFD              ; –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ä—à–∏–π –±–∞–π—
                             Ç —Ç–∞–π–º–µ—Ä–∞ (FD = 11111101)
805A 758AFD           73             mov             TL0, #0xFD              ; –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–ª–∞–¥—à–∏–π –±–∞–π—
                             Ç —Ç–∞–π–º–µ—Ä–∞
805D 438840           74             orl             TCON, #01000000b                ; —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ –ø–
                             µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ 0 –∏ —Ñ–ª–∞–≥–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å—á—ë—Ç–∞ 1 –¥–ª—è —Ç–∞–π–º–µ—Ä–∞ T1 
                      75                                                                                     ; (–≤–∫–ª—é
                             —á–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞): –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑    setb    TR1
                      76     
                      77     ; –ü–†–ò–Å–ú –ü–û –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–ú–£ –ü–û–†–¢–£
8060 3098FD           78             jnb             RI, $           ; –ü–æ–¥–æ–∂–¥–∞—Ç—å –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø—Ä–∏—ë–º–
                             ∞ –±–∞–π—Ç–∞ –ø–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º—É –ø–æ—Ä—Ç—É
8063 E599             79             mov             a, SBUF                 ; –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ –∞–∫–
                             ∫—É–º—É–ª—è—Ç–æ—Ä 
8065 F6               80             mov             @r0, a                  ; –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ø—Ä–∏–Ω—è—Ç—ã–π –
                             ±–∞–π—Ç –≤ CDATA (–ø–æ –∞–¥—Ä–µ—Å—É –°–û–ú_DATA)
                      81             
                      82     ; –í–´–í–û–î –î–ê–ù–ù–´–• –ù–ê –ñ–ö-–î–ò–°–ü–õ–ï–ô
8066 EE               83             mov             a, r6                           ; —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞–∫–æ–º–µ—Å—Ç
A51 MACRO ASSEMBLER  LR2                                                                  10/22/2023 11:13:52 PAGE     3

                             –æ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ –ñ–ö-–¥–∏—Å–ø–ª–µ—è (–ø–æ –∞–¥—Ä–µ—Å—É 80h+ –≤ DRAM)
8067 0E               84             inc             r6                                      ; "–ø–µ—Ä–µ—Ö–æ–¥" –Ω–∞ —Å–
                             ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞–∫–æ–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∏ –ñ–ö-–¥–∏—Å–ø–ª–µ—è
8068 118A             85             call    write_comand            ; –≤—ã–∑–æ–≤ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –∑–∞–ø–∏—Å–∏ 
                             –∫–æ–º–∞–Ω–¥ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–∏—Å–ø–ª–µ—è
                      86             
806A 900030           87             mov     dptr, #COM_DATA         ; –≤ —É–∫–∞–∑. –∞–¥—Ä–µ—Å —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–∏–Ω
                             —è—Ç–æ–≥–æ –±–∞–π—Ç–∞ (—Å–∏–º–≤–æ–ª–∞)
                      88     
806D E4               89             clr     a                                       ; –æ—á–∏—Å—Ç–∫–∞ –∞–∫–∫—É–º—É–ª—è—Ç
                             –æ—Ä–∞
806E E6               90             mov     a, @r0                  ; –≤ –∞ —Å–∏–º–≤–æ–ª –ø–æ –∞–¥—Ä–µ—Å—É –≤ R0
806F 11A7             91             call    write_data              ; –≤—ã–∑–æ–≤ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –∑–∞–ø–∏—Å–∏ 
                             –¥–∞–Ω–Ω—ã—Ö
                      92     
8071 08               93             inc             r0                                      ; —Å–¥–≤–∏–≥ –Ω–∞ —Å–ª–µ–¥—
                             É—é—â–∏–π –∞–¥—Ä–µ—Å
8072 22               94     ret
                      95     ; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      96     
                      97     ; --- –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø–∏—Å–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–∞–Ω
                             –¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∏—Å–ø–ª–µ—è --------------
8073                  98     lcdini:
8073 C290             99             clr             p1.0            ; —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–∞ –ï=0
8075 11C8            100             call    del                             ; –≤—ã–∑–æ–≤ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ –≤—Ä–µ–º
                             —è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞
                     101     
8077 7428            102             mov             a, #28h         ; 0 0 1 DL N F x x = 0010 1000 = 28h
                     103                                                             ; (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–æ–±—Ä–∞–
                             ∂–µ–Ω–∏—è –∏ —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å –≤—Ö–æ–¥. –¥–∞–Ω–Ω—ã—Ö) 
                     104                                                             ; –∫–æ–º–∞–Ω–¥–∞ –ø–µ—Ä–µ–≤–æ–¥–∞  
                             –≤ 4-—Ö —Ä–∞–∑—Ä—è–¥–Ω—ã–π (D/L=0) —Ä–µ–∂–∏–º –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö 5x8 —Ç–æ—á–µ–∫ (F=0)
8079 118A            105             call    write_comand            ; –∑–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–∞–Ω–¥—É
807B 11C8            106             call    del                                     ; –≤—ã–∑–æ–≤ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ 
                             –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞
                     107     
807D 740C            108             mov             a, #0Ch                 ; 0 0 0 0 1 D C B = 0000 1110 = 0Eh (–≤—ã–±
                             –æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)
                     109                                                             ; –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∏–º–≤–æ
                             –ª–æ–≤ (D=1) "–≤–∫–ª." 
                     110                                                             ; –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—É—Ä—Å–æ
                             —Ä–∞ –≤ –≤–∏–¥–µ —á–µ—Ä—Ç–æ—á–∫–∏ (–°=1) "–≤–∫–ª." 
                     111                                                             ; (B=0) - –∫—É—Ä—Å–æ—Ä –Ω–µ –≤–∏–¥–
                             µ–Ω
807F 118A            112             call    write_comand            ; –∑–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–∞–Ω–¥—É
8081 11C8            113             call    del                                     ; –≤—ã–∑–æ–≤ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ 
                             –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞
                     114     
8083 7406            115             mov             a, #06h         ; 0 0 0 0 0 1 I/D S = 0000 0110 = 06h
                     116                                                     ; (–ó–∞–¥–∞–µ—Ç—Å—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 
                             —Å–¥–≤–∏–≥–∞ –∫—É—Ä—Å–æ—Ä–∞ –∏–ª–∏ —Å–∏–º–≤–æ–ª–æ–≤ (—ç–∫—Ä–∞–Ω–∞))
                     117                                                     ; –∞–≤—Ç–æ–º–∞—Ç. —Å–¥–≤–∏–≥ –∫—É—Ä—Å–æ—Ä–∞
                              (S=0)
                     118                                                     ; —Å–¥–≤–∏–≥ —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ (I/D
                             =1) –ø–æ—Å–ª–µ –≤—ã–≤–æ–¥–∞ –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
8085 118A            119             call    write_comand            ; –∑–∞–ø–∏—Å–∞—Ç—å –∫–æ–º–∞–Ω–¥—É
8087 11C8            120             call    del                                     ; –≤—ã–∑–æ–≤ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ 
                             –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞
8089 22              121     ret
                     122     
                     123     ; --- –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø–∏—Å–∏ –∫–æ–º–∞–Ω–¥—ã –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–∏—Å–ø
                             –ª–µ—è --------------------------------
808A                 124     write_comand:           
808A 11CD            125             call    wait_bf                 ; –æ–ø—Ä–æ—Å –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –ñ–ö-–¥–∏—Å–ø–ª–µ—è
                     126     
                     127             ;push   acc
A51 MACRO ASSEMBLER  LR2                                                                  10/22/2023 11:13:52 PAGE     4

                     128             ;push   b
                     129     
808C F5F0            130             mov     b, a                    ; –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—
                             ã—Ö –¥–∞–Ω–Ω—ã—Ö
                     131             
808E 54F0            132             anl     a, #11110000b           ; p7-p4: c—Ç–∞—Ä—à–∞—è —Ç–µ—Ç—Ä–∞–¥–∞ –¥–∞–Ω–Ω—ã—Ö 
                             (p3: "0" => NC.)
                     133                                                                     ; (p0)p2: "0" => E=0
                     134                                                                     ; (p2)p1: "0" => R/[!W] - –
                             ∑–∞–¥–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö 
                     135                                                                     ; (p1)p0: "0" => [C]/D - –≤
                             —ã–±–æ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥ IR
                     136     
8090 F590            137             mov     p1, a                   ; –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –ø–æ—Ä—Ç –ú–ö
                     138             
8092 D290            139             setb    p1.0                    ; E=1
8094 00              140             nop                                                     ; 1 –ú—Ü > 230 –Ω—Å
8095 C290            141             clr     p1.0                    ; E=0
                     142     
8097 E5F0            143             mov     a,b
8099 C4              144             swap    a                       ; –æ–±–º–µ–Ω –º–µ—Å—Ç–∞–º–∏ —Ç–µ—Ç—Ä–∞–¥
809A 54F0            145             anl     a, #11110000b           ; p7-p4: –º–ª–∞–¥—à–∞—è —Ç–µ—Ç—Ä–∞–¥–∞ –¥–∞–Ω–Ω—ã—Ö
                              (p3: "0" => NC.)
                     146                                                                     ; –¥–∞–ª–µ–µ –≤—Å—ë –∞–Ω–∞–
                             ª–æ–≥–∏—á–Ω–æ 1-–º—É —Ü–∏–∫–ª—É –∑–∞–ø–∏—Å–∏
                     147     
809C F590            148             mov     p1, a                   
                     149             
809E D290            150             setb    p1.0                    
80A0 00              151             nop
80A1 C290            152             clr     p1.0                    
                     153     
80A3 7590F0          154             mov     p1, #11110000b          ; —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ª–∏–Ω–∏—è—Ö BD4‚ÄìBD7 —Å
                             –∏–≥–Ω–∞–ª–æ–≤ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è
                     155                                                                     ; (p0)p2: "0" => E=0
                     156                                                                     ; (p2)p1: "0" => R/[!W] - –
                             ∑–∞–¥–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö 
                     157                                                                     ; (p1)p0: "0" => [C]/D - –≤
                             —ã–±–æ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥ IR
                     158             ;pop    b
                     159             ;pop    acc
80A6 22              160     ret
                     161     
                     162     ; --- –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–∏—Å–ø–ª
                             –µ—è ---------------------------------
80A7                 163     write_data:
80A7 11CD            164             call    wait_bf                 ; –æ–ø—Ä–æ—Å –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –ñ–ö-–¥–∏—Å–ø–ª–µ—è
                     165     
                     166             ;push   acc
                     167             ;push   b
                     168     
80A9 F5F0            169             mov     b, a                    ; –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—
                             ã—Ö –¥–∞–Ω–Ω—ã—Ö
                     170             
80AB 54F0            171             anl     a, #11110000b           ; p7-p4: c—Ç–∞—Ä—à–∞—è —Ç–µ—Ç—Ä–∞–¥–∞ –¥–∞–Ω–Ω—ã—Ö 
                             (p3: "0" => NC.)
80AD 4402            172             orl     a, #00000010b           ; (p0)p2: "0" => E=0
                     173                                                                     ; (p2)p1: "0" => R/[!W] - –
                             ∑–∞–¥–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö 
                     174                                                                     ; (p1)p0: "1" => C/[D] - –≤
                             —ã–±–æ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö RD
                     175             
80AF F590            176             mov     p1, a                   ; –≤—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–æ—Ä—Ç –ú–ö
                     177             
80B1 D290            178             setb    p1.0                    ; E=1
80B3 00              179             nop                                                     ; 1 –ú—Ü > 230 –Ω—Å
A51 MACRO ASSEMBLER  LR2                                                                  10/22/2023 11:13:52 PAGE     5

80B4 C290            180             clr     p1.0                    ; E=0
                     181     
80B6 E5F0            182             mov     a,b                     ; "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ" –∏—Å—Ö–æ–¥–Ω—ã—Ö –
                             ¥–∞–Ω–Ω—ã—Ö
80B8 C4              183             swap    a                       ; –æ–±–º–µ–Ω –º–µ—Å—Ç–∞–º–∏ —Ç–µ—Ç—Ä–∞–¥
80B9 54F0            184             anl     a, #11110000b           ; p7-p4: –º–ª–∞–¥—à–∞—è —Ç–µ—Ç—Ä–∞–¥–∞ –¥–∞–Ω–Ω—ã—Ö
                              (p3: "0" => NC.)
80BB 4402            185             orl     a, #00000010b           ; –¥–∞–ª–µ–µ –≤—Å—ë –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ 1-–º—É —Ü–
                             ∏–∫–ª—É –∑–∞–ø–∏—Å–∏
                     186     
80BD F590            187             mov     p1, a                   
                     188             
80BF D290            189             setb    p1.0                    
80C1 00              190             nop
80C2 C290            191             clr     p1.0                    
                     192             
80C4 7590F0          193             mov     p1, #11110000b          ; —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ª–∏–Ω–∏—è—Ö BD4‚ÄìBD7 —Å
                             –∏–≥–Ω–∞–ª–æ–≤ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è
                     194                                                                     ; p2: "0" => E=0
                     195                                                                     ; p1: "0" => R/[!W] - –∑–∞–
                             ¥–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö 
                     196                                                                     ; p0: "0" => [C]/D - –≤—ã–±
                             –æ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥ IR
                     197             ;pop    b
                     198             ;pop    acc
80C7 22              199     ret
                     200     
                     201     ; --- –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä
                             –µ–∂–∏–º–∞ ------------------------------
                     202     
80C8                 203     del:
80C8 7F00            204                     mov             r7, #0  ; –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è –ø
                             –∏—Ç–∞–Ω–∏—è
80CA DFFE            205                     djnz    r7, $           ; (–ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–µ–±—è 255 -> FF —Ä–∞–∑)
80CC 22              206     ret
                     207     
                     208     ; --- –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –æ–ø—Ä–æ—Å–∞ –±–∏—Ç–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –íF ---------------
                             ----------------------------
80CD                 209     wait_bf:
80CD C0E0            210             push acc
                     211     
80CF                 212             wait_ll:
80CF 7590F4          213                     mov     p1, #11110100b  ; "1" "1" "1" "1" "0" "E" "R/!W" "!C/D"
                     214                                                                             ; p7-p4: => "1" + p
                             3: => "0" (NC.)
                     215                                                                             ; (p0)p2: => E=0
                     216                                                                             ; (p2)p1: [R]/!W=1 
                             => "—á—Ç–µ–Ω–∏–µ IR"
                     217                                                                             ; (p1)p0: [C]/D=0 =
                             > "–æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ IR"
80D2 D290            218                     setb    p1.0            ; E=1
80D4 E590            219                     mov     a, p1           ; —á—Ç–µ–Ω–∏–µ —Å—Ç–∞—Ä—à–µ–π —Ç–µ—Ç—Ä–∞–¥—ã —Ä–µ–≥
                             –∏—Å—Ç—Ä–∞ IR
80D6 C290            220                     clr     p1.0                    ; E=0
80D8 F5F0            221                     mov     b, a            ; –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—à–µ–
                             π —Ç–µ—Ç—Ä–∞–¥—ã
                     222     
80DA D290            223                     setb    p1.0            ; E=1
80DC E590            224                     mov     a, p1           ; —á—Ç–µ–Ω–∏–µ –º–ª–∞–¥—à–µ–π —Ç–µ—Ç—Ä–∞–¥—ã
80DE C290            225                     clr     p1.0                    ; E=0
80E0 E5F0            226                     mov     a, b
80E2 20E7EA          227         jb  acc.7, wait_ll                  ; –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∏—Ç–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ BF (
                             BF=1 - –∑–∞–Ω—è—Ç)
80E5 D0E0            228             pop acc
80E7 22              229     ret
                     230     
A51 MACRO ASSEMBLER  LR2                                                                  10/22/2023 11:13:52 PAGE     6

                     231     end
                             ; ======================================================================================
A51 MACRO ASSEMBLER  LR2                                                                  10/22/2023 11:13:52 PAGE     7

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . .  D ADDR   00E0H   A   
B. . . . . . . . .  D ADDR   00F0H   A   
COM_DATA . . . . .  D ADDR   0030H   A   
DEL. . . . . . . .  C ADDR   80C8H   A   
FRST . . . . . . .  N NUMB   0080H   A   
IE . . . . . . . .  D ADDR   00A8H   A   
INT_UART . . . . .  C ADDR   804BH   A   
LCDINI . . . . . .  C ADDR   8073H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
RI . . . . . . . .  B ADDR   0098H.0 A   
SBUF . . . . . . .  D ADDR   0099H   A   
SCON . . . . . . .  D ADDR   0098H   A   
START. . . . . . .  C ADDR   8040H   A   
TCON . . . . . . .  D ADDR   0088H   A   
TH0. . . . . . . .  D ADDR   008CH   A   
TL0. . . . . . . .  D ADDR   008AH   A   
TMOD . . . . . . .  D ADDR   0089H   A   
WAIT_BF. . . . . .  C ADDR   80CDH   A   
WAIT_LL. . . . . .  C ADDR   80CFH   A   
WRITE_COMAND . . .  C ADDR   808AH   A   
WRITE_DATA . . . .  C ADDR   80A7H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
